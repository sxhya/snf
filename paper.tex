\documentclass[oneside, 10pt]{amsart}
\usepackage{amscd, amsmath, amssymb, amsthm, amsfonts, amstext, geometry, verbatim, enumitem, graphicx, mathtools, xfrac, microtype, nameref, thmtools}
\usepackage[breaklinks=true]{hyperref}
\usepackage[capitalize]{cleveref}
\usepackage[hyperref=true, backend=bibtex, firstinits=true, citestyle=numeric-comp, sortlocale=en_US, url=false, doi=false, eprint=true, maxbibnames=4]{biblatex}            
%\usepackage[notref,notcite]{showkeys}
\usepackage[matrix,arrow,curve]{xy}
\usepackage[toc,page]{appendix}

\addbibresource{paper.bib}
\renewbibmacro*{volume+number+eid}{\ifentrytype{article}{\- \iffieldundef{volume}{}{Vol.~\printfield{volume},}\iffieldundef{number}{}{ No.~\printfield{number},}}}
\renewbibmacro{in:}{\ifentrytype{article}{}{\printtext{\bibstring{in}\intitlepunct}}}
\newbibmacro{string+doi}[1]{\iffieldundef{doi}{\iffieldundef{url}{#1}{\href{\thefield{url}}{#1}}}{\href{http://dx.doi.org/\thefield{doi}}{#1}}}
\DeclareFieldFormat[article, inproceedings, inbook, book, thesis]{title}{\usebibmacro{string+doi}{\mkbibquote{#1}}}
\renewcommand*{\bibfont}{\footnotesize}

%\newlist{lemlist}{enumerate}{1} \setlist[lemlist]{label={\rm(\arabic{lemlisti})}, ref=\thelemma.(\arabic{lemlisti}),noitemsep} \Crefname{lemlisti}{Lemma}{Lemmas}

\theoremstyle{plain}

\newtheorem{thm}{Theorem}
\newtheorem{prop}{Proposition}
\Crefname{thm}{Theorem}{Theorems}
%\numberwithin{equation}{section}

\newtheorem{lemma}{Lemma}
%\numberwithin{lemma}{section}
\Crefname{lemma}{Lemma}{Lemmas}

\newtheorem{cor}[lemma]{Corollary}
\Crefname{cor}{Corollary}{Corollaries}

\Crefname{prop}{Proposition}{Propositions}

\newtheorem*{thm*}{Theorem}
\newtheorem*{lemma*}{Lemma}

\theoremstyle{remark}

\newtheorem{rem}[lemma]{Remark}
\Crefname{rem}{Remark}{Remarks}

\theoremstyle{definition}

\newtheorem{df}[lemma]{Definition} \Crefname{df}{Definition}{Definitions}
\newtheorem{example}[lemma]{Example} \Crefname{example}{Example}{Examples} 
 
\newcommand\SmallMatrix[1]{{%
  \tiny\arraycolsep=0.3\arraycolsep\ensuremath{\begin{pmatrix}#1\end{pmatrix}}}}
\DeclareMathOperator{\St}{St}
\DeclareMathOperator{\E}{E}
\newcommand{\ZZ}{\mathbb{Z}}
\newcommand{\K}{K_2}
\newcommand{\Kmw}{K^{\mathrm{MW}}_2}

\title{$\K$ of Kac---Moody groups, revisited}
\author {Sergey Sinchuk}
\address{Chebyshev laboratory, St. Petersburg State University, St. Petersburg, Russia}
\email {sinchukss at gmail.com}
\date {\today}

\begin{document}   
\begin{abstract} We compute $\K$-group associated to any Kac---Moody group over a field.
 The key ingredient in the computation is a variant of Smith normal form of an integer matrix.
\end{abstract}


\maketitle
%\section{Introduction}
Let $A$ be an indecomposable generalized Cartan matrix and $F$ a field.
The aim of this note is to finish the computation of the unstable $\K$-group $\K(A, F)$ started by M.~Westaway in~\cite{MW}.
Recall from~\cite{MR}, \cite{Ti} that the group $\K(A, F)$ is defined as the kernel of the map 
 $\St(A, F) \to G(A, F)$ between the corresponding Steinberg and Tits' Kac---Moody groups over $F$.

In~\cite{MR} J.~Morita and U.~Rehmann described $\K(A, F)$ as a certain quotient of abelian groups, see~\cref{thm:mr} below. 
This description allows one to immediately compute $\K(A, F)$ in the case when $A$ is finite or affine (see Corollaries~4--5 of \cite{MR}).

For general $A$, however, this description does not lead to an immediate answer and certain computation remains to be done.
In~\cite{MW} this computation was made for {\it hyperbolic} GCMs, a subclass of GCMs of indefinite type. 
Westaway's proof involved case-by-case analysis and, moreover, 
 relied on the classification of hyperbolic GCMs previously obtained by L.~Carbone et al.

In this note we describe a solution of the general problem, namely we describe an algorithm for computing $\K(A, F)$ for arbitrary $A$.
We also reprove some of the results of~\cite{MW} in a simplified form.
Our algorithm is, essentially, a variant of the well-known algorithm for computing Smith normal form of a matrix.
We also show~\cite[Conjecture 9.1]{MW} to be false as stated, and propose a way to corrected its statement.


\section{Proof of the main result}
Throughout this note $F$ denotes an arbitrary field and $A=(a_{ij})$ a generalized Cartan matrix of size $n$.
Denote by $M_A$ the subgroup of the free abelian group $\ZZ^n = \ZZ e_1 \oplus \ldots \oplus \ZZ e_n $ generated by all 
 linear combinations of the form $a_{ji} e_i - a_{ij} e_j$, $1\leq i<j\leq n$.
Set $G_A = \ZZ^n/M_A$.

Let us first recall the precise statement of the result of Morita and Rehmann.
Denote by $L_i$ either the Milnor group $\K(F)$ or the Milnor---Witt group $\Kmw(F)$ 
 depending on whether or not there exists $1 \leq k \leq n$ such that the matrix coefficient $a_{ki}$ is odd.
In either case we denote the Steinberg symbols (resp. cocycles) generating the group $L_i$ by $\{x,y\}_i$, $x, y\in F^\times$
 (see~\cite[Proposition~5.5, Lemme~5.6]{Ma} for the definition of Steinberg cocycles and symbols, respectively).
We always use additive notation for abelian groups $\K(F)$ or $\Kmw(F)$.
 
\begin{thm}[Morita---Rehmann] \label{thm:mr} 
 $\K(A, F)$ is isomorphic to the quotient $L/J$ where $L = L_1 \oplus L_2 \oplus \ldots \oplus L_n$ and 
 $J$ is the subgroup of $L$ generated by relators $\{x, y^{a_{ji}}\}_i - \{x^{a_{ij}}, y\}_j = 0$.
\end{thm}

Now, let us recall how $\K(A, F)$ can be computed in the special case when each column of $A$ contains an odd entry.
The following result is proved in~\cite{MW} (cf.~Theorem~5.1]).
\begin{thm} \label{thm-odd}
  Assume that every column of $A$ contains an odd entry. Assume, moreover, that
  $G_A \cong \mathbb{Z}/r_1\mathbb{Z} \oplus \ldots \oplus \mathbb{Z}/r_s\mathbb{Z} \oplus \mathbb{Z}^{n-s}\text{ for some } r_i | r_{i+1}.$
  Then 
  \begin{equation} \label{thm-eq}
    \K(A, F) \cong \frac{\K(F)}{r_1 \K(F)} \oplus \ldots \oplus \frac{\K(F)}{r_s \K(F)} \oplus \K(F)^{n-s}.
  \end{equation}
\end{thm}
\begin{proof}
 Notice that $\{x, y^k\}_i = \{x^k, y\}_i = k\{x,y\}_i$ for all $k$ and $1\leq i\leq n$.
 
 We already know by~\cref{thm:mr} that $\K(A, F)$ is the quotient of the abelian group 
  $\K(F)^n \cong \K(F) \otimes_{\mathbb{Z}} (\mathbb{Z}e_1 \oplus \ldots \oplus \mathbb{Z}e_n)$ by the subgroup
  \[\langle a_{ji}\{u, v\}_i - a_{ij}\{u, v\}_j \rangle \cong \langle \{u, v\} \otimes (a_{ji} e_i - a_{ij} e_j)\rangle = \K(F) \otimes M_A. \]
 Since $\{u, v\}$ generate $\K(F)$ we get $\K(A, F) \cong \K(F) \otimes (\mathbb{Z}^n / M_A) = \K(F) \otimes G_A$,
  the latter expression coincides with the expression in the right-hand side of~\eqref{thm-eq}. 
\end{proof}

Of course, the integers $r_i$ can be concretely obtained as the 
  the diagonal coefficients in the Smith normal form of the $\frac{n(n-1)}{2}\times n$ matrix $\widetilde{A}$ given by
\begin{equation} \label{eq:Aijk} \widetilde{A}_{i<j, k} = \left\{\def\arraystretch{1.2}%
  \begin{array}{@{}c@{\quad}l@{}}
     a_{ij} & \text{ for } k = i, \\
    -a_{ji} & \text{ for } k = j, \\
    0 & \text{otherwise.}    
  \end{array}\right.\end{equation}                    
Notice that the integer $s$ from the statement of~\cref{thm-odd} is precisely the number of nonzero $r_i$'s.
  
In the case when all entries of $A$ are even, the coefficients $r_i$ are even as well and the group $\K(A, F)$ can be computed just as easily.
%Compare the following result with~\cite[Theorem~6.1]{MW}, which is its special case.
\begin{thm} \label{thm-even}
  Assume that all entries of $A$ are even.
  Assume, moreover, that $G_A \cong \ZZ / r_1 \ZZ \oplus \ldots \oplus \ZZ / r_s\ZZ \oplus \ZZ^{m-s}$ for some $r_i$ satisfying $r_i | r_{i+1}$.
  Then
   \[\K(A, F) \cong \frac{\Kmw(F)}{(r_1/2) I} \oplus \ldots \oplus \frac{\Kmw(F)}{(r_s/2) I} \oplus \Kmw(F)^{m-s}, \]
    where $I$ denotes the subgroup of $\Kmw(F)$ generated by $\{x^2, y\}$, $x, y\in F^\times$.
\end{thm}
\begin{proof}
 Recall from ~\cite[Lemma~3.2]{MW} that
 \[\{x, y^{2k}\}_i = \{x^{2k}, y\}_i = k\{x,y^2\}_i = k\{x^2, y\}_i \text{ for all } k\text{ and } 1\leq i\leq n.\]
 By~\cref{thm:mr} the group $\K(A, F)$ is the quotient of
  $\Kmw(F) \otimes \ZZ^n$ by the subgroup 
  \[\left\langle \frac{a_{ji}}{2}\{x^2, y\}_i - \frac{a_{ij}}{2}\{x^2, y\}_j \right\rangle \cong \left\langle 
   \{x^2, y\} \otimes \left(\frac{a_{ji}}{2} e_i - \frac{a_{ij}}{2} e_j\right)\right\rangle,\ x,y\in F^\times. \]
 Thus we get that $\K(A, F) \cong \left(\Kmw(F) \otimes \ZZ^n\right) / (I \otimes M_A/2),$ as claimed. 
\end{proof}
Notice that \cite[Theorem~6.1]{MW} formally follows from the above theorem.

Now we turn to the case when $A$ contains columns of both types 
(i.\,e. there are columns having an odd entry, and consisting only of even entries).
The basic idea remains the same: we need to find a nice basis for the subgroup $J\leq L$ of defining relations of $\K(A, F)$.
This time, however, the situation is more tricky since we cannot simply tensor out $\K(F)$ or $\Kmw(F)$.
To solve the problem we need to invent some analogue of the fundamental theorem of finitely-generated abelian groups suitable to our sitation.
%We solve the problem have to keep track of its columns' ``parities''.

We need to introduce the notion of a {\it matrix with parity}.
By definition, it is simply a pair $(b, p_b)$ consisting of an integer $m\times n$ matrix $b$ and a column function $p_b\colon \{1,\ldots,n\}\to \{odd, even\}$,
 such that entries $b_{ij}$ are even for all $i$ given $p_b(j)=even$.
We call function $p_b$ a {\it parity function}.
We also call the corresponding column $b_{*i}$ {\it odd} or {\it even} depending on the value of $p_b(i)$.
%With this notation a matrix with parity is simply a matrix whose even columns consist of even entries.
Notice that we make no assumptions about entries of odd columns.

We now list five types of elementary operations that can be applied to a $m \times n$ matrix with parity $(b, p_b)$.
Later we will see that it is possible to bring a matrix with parity to Smith normal form using these operations.
\begin{enumerate}
 \item \label{item:type1} Arbitrary row operation, i.\,e. the operation that changes $b$ into $gb$ for some $g \in \E(m, \ZZ)$;
 \item \label{item:type2} Interchanging $i$-th and $j$-th columns of $b$ 
  (the corresponding values $p_b(i)$ and $p_b(j)$ of the parity function are also interchanged);
 \item \label{item:type3} Adding a multiple of a column to another column of the same parity;
 \item \label{item:type4} Adding a multiple of an even column to an odd column;
 \item \label{item:type5} Adding an even multiple of an odd column to an even column.
\end{enumerate}
All operations except the one of type~\eqref{item:type2} leave the parity function $p_b$ unchanged.
Operations \eqref{item:type3}--\eqref{item:type5} change $b$ into $bt_{ij}(\xi)$
 for some elementary transvection matrix $t_{ij}(k)$, $1\leq i\neq j\leq n$, $k \in \ZZ$.
Notice that the matrix produced by any of the above transformations is still a matrix with parity.

It is clear how matrix $\widetilde{A}$ can be reinterpreted as a matrix with parity.
Indeed, set $p_{\widetilde{A}}(i) = odd$ (resp. $p_{\widetilde{A}}(i) = even$) if the column $a_{*i}$ of
 $A$ contains an odd entry (resp. consists only of even entries).

Now let $(c, p_c)$ be an $m\times n$ matrix with parity.
Define abelian group $L(p_c)$ as the direct sum $L_1 \oplus \ldots \oplus L_n$, where 
\[L_i=\left\{\def\arraystretch{1.2}%
  \begin{array}{@{}c@{\quad}l@{}}
     \K(F) & \text{if $p_c(i) = odd$,} \\    
     \Kmw(F) & \text{if $p_c(i) = even$}.
  \end{array}\right.\]
As before, we use notation $\{u, v\}_i$ for the Steinberg symbol (or cocycle) of $i$-th summand $L_i$.
We associate to $i$-th row $c_{i*}$ of $c$ the following element of $L(p_c)$:
\[r_{c,i}(u, v) = \{ u^{c_{i1}}, v\}_1 + \ldots + \{u^{c_{in}}, v\}_{n},\ \ u, v\in F^\times.\]
Define $J(c)$ to be the subgroup of $L(p_c)$ generated by $r_{c, i}(u, v)$ for $1\leq i\leq m$, $u, v\in F^\times.$
It is clear that $L(p_c)$ and $J({\widetilde{A}})$ coincide with $L$ and $J$ from the statement of~\cref{thm:mr}.

\begin{lemma} \label{lm:inv} The isomorphism class of the quotient $L(p_c)/J(c)$ is not changed
 by any of the above five elementary transformations of $(c, p_c)$. \end{lemma}
\begin{proof}
 %Assertion of the lemma is not immediately obvious only for operations of type \eqref{item:type4} and \eqref{item:type5}. 
 Let us verify the assertion of the lemma, for example, for the operation of type~\eqref{item:type5}
  (for other operations it is similar but easier).
 Assume that $c'$ is the matrix obtained from $c$ by applying operation of type~\eqref{item:type5}.
 
 To verify the assertion of the lemma it suffices to show that $J(c')$ is the image of $J(c)$ under an automorphism of $L(p_c)$.
 Speaking in terms of bases, it suffices to describe how the ``new'' symbols $\{u, v\}_i'$ corresponding to $c'$ 
  are expressed in terms of ``old'' symbols $\{u, v\}_i$ corresponding to $c$.  
 
 By assumption, $c' = c \cdot t_{ij}(2k)$ for some $i$, $j$ satisfying $p_c(i)=odd$, $p_c(j)=even$.
 This operations corresponds to the following change of basis of $L(p_c)$:
 \[ \{u, v\}_{i}^{'} = \{u, v\}_i - 2k\{u, v\}_j;\ \ \{u, v\}_{j}^{'} = \{u, v\}_j.\]
 It remains to see that $\{u, v\}_{i}^{'}$ is a Steinberg symbol.
 Although $\{u, v\}_j$ is merely a cocycle, $2k\{u, v\}_j = \{u^{2k}, v\}_j$ is a symbol (cf.~\cite[Lemma~3.2(vii)]{MW}).
 Since $\{u, v\}_{i}^{'}$ is a linear combination of symbols, it is a symbol as well.
\end{proof}

\begin{lemma} \label{lm:normal-form} Any $m \times n$ integer matrix with parity $(c, p_c)$ can be transformed into a diagonal matrix $(d, p_d)$
  ($d = \mathrm{diag}(r_1, \ldots r_{\mathrm{min}(m, n)})$, $r_i | r_{i+1}$)
   by means of elementary operations of types~\eqref{item:type1}--\eqref{item:type5}.
\end{lemma}
\begin{proof} 
Recall that one of the working steps of the classical algorithm for finding Smith normal form involves
 addition of one of the two fixed columns (say, $i$-th and $j$-th ones) to another
 so that, unless it was zero from the start, the minimum of $|c_{ki}|$ and $|c_{kj}|$ decreases strictly 
 (here $k$ is some row number and $i$, $j$ are some column numbers selected by the algorithm on one if its steps).

To adapt the classical algorithm to the situation of matrices with parities it suffices to describe
 how the modified algorithm performs the same operation in the case when the selected columns have different parities.
Indeed, the our elementary operations differ from the usual ones only in that they do not allow adding odd multiples of odd columns to even columns.

Suppose that $i$-th column of $c$ is odd and $j$-th one is even.

In the case $|c_{ki}| \geq |c_{kj}|$, write $c_{ki} + q c_{kj} = r$ for some $q$ and $r$, satisfying $|r| < |c_{kj}|$.
Using an operation of type~\eqref{item:type4} we add $q \cdot c_{*j}$ to $c_{*i}$ so that $\min(|c_{ki}|, |c_{kj}|)$ indeed decreases strictly.

In the case $|c_{ki}| < |c_{kj}|$, write $c_{kj} + q c_{ki} = r$ for some $q$ and $r$, satisfying $|r| < |c_{ki}|$.
If $q$ is even, we use an operation of type~\eqref{item:type5} to add $q \cdot c_{*i}$ to $c_{*j}$ and we are done again.
Otherwise, we can choose even $q'$ equal to either $q-1$ or $q+1$ so that one of the following is true:
\begin{itemize}
 \item $r\neq 0$ and $|c_{kj} + q' c_{ki}| < |c_{ki}|$;
 \item $r = 0$ and $c_{kj} + q' c_{ki} = c_{ki}$.
\end{itemize}
After adding $q' \cdot c_{*i}$ to $c_{*j}$ we are either done again (first case), or 
 need to further subtract $c_{*j}$ from $c_{*i}$ to get $c_{ki} = 0$ (second case).
\end{proof}

Once $(\widetilde{A}, p_{\widetilde{A}})$ is reduced to the diagonal form, the group $\K(A, F)$ can be calculated as follows.
Each zero diagonal coefficient $r_i$ produces one summand in $\K(A, F)$ which, depending on the parity of $i$-th column, is isomorphic to either $\K(F)$ or $\Kmw(F)$, whereas
 each nonzero coefficient $r_i \neq 0$ gives one summand $\K(F)/(r_i \K(F))$ or $\Kmw(F) / ((r_i/2) I)$.

Now suppose that columns of $A$ (and hence of $\widetilde{A}$) are ordered in such a way that
 each of the first $k$ columns contains and odd entry, and the remaining $n-k$ columns consist of even entries.
The algorithm described in~\cref{lm:normal-form} allows us to present
 $\widetilde{A}$ as $p \cdot d \cdot q $ for some $q \in \E(n, \ZZ)$, $p \in \E(n(n-1)/2, \ZZ)$, $d = \mathrm{diag}(r_1, \ldots r_n)$.

It is clear that $i$-th column of $d$ is odd if and only if coefficients $q_{ij}$ are even for $k+1\leq j \leq n$
 (to see this look at everything modulo $2$).
Alternatively, $i$-th column of $d$ is odd if and only if one of the coefficients $q'_{ji}$ of the inverse matrix $q^{-1}$ is odd for some $1\leq j\leq k$.

This means, that \cite[Conjecture~9.1]{MW} is true in the special case when Westaway's matrices $\nu$, $\mu$ (which equal our $q^t$, ${q^{-1}}^t$) 
 are obtained via the algorithm described above.
Notice, however, that this criterion is not applicable for $q$ obtained from {\it arbitrary} SNF decomposition $\widetilde{A} = p d q$.
Thus, as stated in~\cite{MW}, Conjecture~9.1 is false.

%A = 
%2, -2, -3, 0
%-2, 2, -2, -4
%-1, -2, 2, 0
%0, -4, 0, 2


\printbibliography
%\begin{thebibliography}{MMMM}
%\bibitem{Li}  {\sc B.~Liehl}, {On the group $SL_2$ over orders of arithmetic type}, J. Reine Angew. Math., 323, 153--171, (1981).
%\end{thebibliography}

\end{document}
